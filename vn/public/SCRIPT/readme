# 주석
일반 텍스트 (나레이션 등)
이름 -> 대사

@명령 인자1 인자2 인자3 ...

# 특수 명령어
# VN 시스템과 통신하는 명령어
# 다음은 사용할 수 있는 명령어 목록
#  title -> 타이틀 화면으로 돌아감
#  unlock-all -> 모든 컬렉션 요소 해금
# 존재하지 않는 명령어는 "무시됨"
@command command [args...]

# 선택지
# 인자는 반드시 짝수개여야 함
# 홀수 인자는 표시되는 선택지 텍스트이고, 짝수 인자는 해당 선택지가 선택되었을 때 이동할 스크립트 이름
# 스크립트 이름이 - 라면 스크립트를 변경하지 않고 다음 명령을 실행함
@sel sel1 sel1to [sel2 sel2to ...]

# 챕터 이름 지정 (문자열)
@chapter chap

# 장소 등 제목 지정
@title title

# 대사창 닫기
@clear

# 각종 효과
@fx fxName [fxArg1 fxArg2 ...]

# 화면 페이드 인/아웃
# 검은 색상으로 덮음, duration 시간을 들여서 전환 (초 단위)
@fadein [duration=1]
@fadeout [duration=1]

# 특정 시간 또는 효과 대기
# wait이 숫자일 경우 해당 초만큼 대기, "fx"일 경우 진행중인 효과가 끝날 때까지 대기
@wait wait

# 스크립트 파일 로드
@script file

# 배경 이미지
# 항상 Fade 없으며 - 입력 시 배경 삭제
@bg image

# 캐릭터 표시
# image가 "-" 라면 기존 캐릭터를 제거
# position은 << < left center right > >> 중 선택
#  각각 0% 0% 25% 50% 75% 100% 100% 지점에 위치
#  < 및 > 는 절반 잘리게 표시되며, << 및 >> 는 잘리지 않게 표시됨 (마진 처리를 위해 10px 잘림)
# fx는 진입/제거 효과, "" left top right bottom 중 선택, ""는 페이드 인/아웃
#   방향 지정 시 해당 방향에서 진입 또는 해당 방향으로 제거됨
# duration 시간만큼 fx로 표현됨 (초 단위)
# scale 만큼 확대됨 (배율)
@char image [position=center] [fx=""] [duration=0.5] [scale=1]

# 이미지 표시
# id는 숫자 형식이어야 함
# image가 - 라면 기존 이미지를 제거
# fade는 진입/제거 페이드 시간 (초 단위)
# position은 left-top top right-top left center right left-bottom bottom right-bottom 중 선택
# bpic은 char보다 뒤에 표시되며, pic과 id를 공유함
@pic id image [fade=0] [position=center]
@bpic id image [fade=0] [position=center]

# 색상 필터
# 캐릭터 또는 이미지에 색상 필터를 적용하며, 현재 적용된 색상 필터 매트릭스에서 도착 값까지 서서히 변경함
# type은 char 또는 pic 중 선택하며, type이 char일 경우 position, pic일 경우 id에 대응됨
# char은 완전히 표시된 이미지에 한해 적용됨 (같은 위치에 완전히 표시된 이미지는 단 하나로 한정되기 때문)
# duration 만큼 시간을 들여서 변화시키며, 초 단위임
# 5x4 색상 매트릭스를 이용하며, 값은 0.0 ~ 1.0 범위를 가짐
# 0.0 ~ 1.0 범위를 벗어나는 값은 0.0 또는 1.0 으로 잘림
# RGBA 4개만 입력하여 축약 가능
# bfilter는 해당 이미지의 뒤쪽에 영향이 감 (실제 이미지가 위치한 영역만 적용됨)
# 5x4 색상 매트릭스 https://developer.mozilla.org/en-US/docs/Web/SVG/Element/feColorMatrix
@filter type id_or_position duration m1 m2 m3 m4 m5 m6 m7 m8 m9 m10 m11 m12 m13 m14 m15 m16 m17 m18 m19 m20
@filter type id_or_position duration R G B A

@bfilter type id_or_position duration m1 m2 m3 m4 m5 m6 m7 m8 m9 m10 m11 m12 m13 m14 m15 m16 m17 m18 m19 m20
@bfilter type id_or_position duration R G B A

# BGM/BGS 변경
# BGM 또는 BGS를 변경, - 입력시 재생 중단
# duration 시간을 들여서 볼륨 fade (재생 중단도 동일)
# wait이 1이라면 fade하는 동안 대기하며, 0 1 중 선택
# BGS는 효과음 볼륨을 따라감
@bgm bgm [duration=0] [wait=1]
@bgs bgs [duration=0] [wait=1]

# SE 재생
# 1회만 재생되는 사운드를 출력
# 만약 se가 - 라면 재생중인 모든 se를 중단
@se se

# 값 저장
@set name value

# @set 으로 저장된 값에 따라 분기
# 모든 조건을 만족하지 못했다면 다음 명령을 실행
@if name value1 to1 [value2 to2 ...]

# 대사창 텍스트 스타일 지정
# style은 normal, bold, italic, bi 사용 가능
# bi = bold+italic
@style style


##########################################

# 화면 흔들기
# 배경과 캐릭터, 이미지를 흔듬
# strength는 weak normal strong 중 선택
# duration은 화면을 한 번 이동할 때 걸리는 시간
# count는 총 화면을 몇 번 이동할지 여부, -1 라면 무한 반복
# 효과 이름이 shake2 인 경우, 무한 반복 사용 불가, 흔들기가 모두 끝난 후에 다음 명령 실행
@fx shake strength [duration=2] [count=1]
@fx shake2 strength [duration=2] [count=1]

# 화면 흔들기 중지
# shake 화면 흔들기를 멈춤
# duration 시간에 걸쳐서 원래 위치로 돌아옴
@fx shake_fadeout [duration=2]

# 캐릭터에 효과 적용
# position 위치에 표시중인 캐릭터에 효과를 적용, position은 left center right 중 선택
# type 효과로 적용, jump jump-short shake shake-weak 사용 가능
@fx charfx position duration type

# filter 또는 bfilter 효과를 identity에서 목표치까지 circle 루프함, ease-in-out-sine
# duration 시간에 걸쳐서 반 사이클을 수행함 (identity -> input -> identity 는 duration*2 만큼 소요)
# 종료될 때는 duration 시간에 걸쳐서 identity로 돌아감
@fx filter-circle type id_or_position duration -
@fx filter-circle type id_or_position duration m1 m2 m3 m4 m5 m6 m7 m8 m9 m10 m11 m12 m13 m14 m15 m16 m17 m18 m19 m20
@fx filter-circle type id_or_position duration R G B A

@fx bfilter-circle type id_or_position duration -
@fx bfilter-circle type id_or_position duration m1 m2 m3 m4 m5 m6 m7 m8 m9 m10 m11 m12 m13 m14 m15 m16 m17 m18 m19 m20
@fx bfilter-circle type id_or_position duration R G B A

##########################################

## - bg Fade 변경 시 예시
# bg 이미지를 fade로 전환
@bpic N "../../BG/filename" fadeTime
# 이후 실제 bg 반영
@bg "filename"
# bpic 제거 (fade 없이)
@bpic N -
